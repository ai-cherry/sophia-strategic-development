{
  "$schema": "http://json-schema.org/draft-04/schema#",
  "version": "2.0",
  "metadata": {
    "name": "Sophia AI Project Intelligence Dashboard",
    "description": "Unified project management across Linear, GitHub, Asana, and Slack",
    "author": "Sophia AI Team",
    "createdAt": "2024-01-20",
    "theme": "dark"
  },
  "resources": [
    {
      "id": "sophia_api",
      "type": "restapi",
      "name": "Sophia AI Backend",
      "config": {
        "baseURL": "{{ environment.API_BASE_URL }}/api/v1",
        "headers": {
          "Authorization": "Bearer {{ localStorage.values.authToken }}",
          "Content-Type": "application/json"
        },
        "timeout": 30000
      }
    },
    {
      "id": "linear_api",
      "type": "graphql",
      "name": "Linear GraphQL",
      "config": {
        "baseURL": "https://api.linear.app/graphql",
        "headers": {
          "Authorization": "{{ environment.LINEAR_API_KEY }}"
        }
      }
    },
    {
      "id": "github_api",
      "type": "restapi",
      "name": "GitHub API",
      "config": {
        "baseURL": "https://api.github.com",
        "headers": {
          "Authorization": "Bearer {{ environment.GITHUB_TOKEN }}",
          "Accept": "application/vnd.github.v3+json"
        }
      }
    }
  ],
  "queries": [
    {
      "id": "getProjectPortfolio",
      "resource": "sophia_api",
      "type": "GET",
      "endpoint": "/projects/portfolio",
      "trigger": "onLoad",
      "transformer": "return formatDataAsArray(data.projects)"
    },
    {
      "id": "getOKRAlignment",
      "resource": "sophia_api",
      "type": "GET",
      "endpoint": "/projects/okr-alignment?quarter={{ quarterSelect.value }}",
      "transformer": "return data"
    },
    {
      "id": "getBlockers",
      "resource": "sophia_api",
      "type": "GET",
      "endpoint": "/projects/blockers",
      "trigger": "onLoad",
      "transformer": "return formatDataAsArray(data.blockers)"
    },
    {
      "id": "getTeamPerformance",
      "resource": "sophia_api",
      "type": "GET",
      "endpoint": "/projects/team-performance?period={{ periodSelect.value }}",
      "transformer": "return data"
    },
    {
      "id": "createLinearIssue",
      "resource": "linear_api",
      "type": "POST",
      "query": "mutation CreateIssue($input: IssueCreateInput!) { issueCreate(input: $input) { success issue { id title } } }",
      "variables": {
        "input": {
          "title": "{{ issueTitle.value }}",
          "description": "{{ issueDescription.value }}",
          "teamId": "{{ teamSelect.value }}",
          "priority": "{{ prioritySelect.value }}",
          "assigneeId": "{{ assigneeSelect.value }}"
        }
      }
    },
    {
      "id": "updateProjectStatus",
      "resource": "sophia_api",
      "type": "POST",
      "endpoint": "/projects/{{ selectedProject.id }}/status",
      "body": {
        "status": "{{ statusSelect.value }}",
        "notes": "{{ statusNotes.value }}"
      }
    },
    {
      "id": "generateReport",
      "resource": "sophia_api",
      "type": "POST",
      "endpoint": "/projects/generate-report",
      "body": {
        "type": "{{ reportTypeSelect.value }}",
        "projects": "{{ projectMultiSelect.value }}",
        "dateRange": "{{ reportDateRange.value }}",
        "includeMetrics": "{{ includeMetricsToggle.value }}"
      }
    },
    {
      "id": "getAIRecommendations",
      "resource": "sophia_api",
      "type": "POST",
      "endpoint": "/projects/ai-recommendations",
      "body": {
        "context": {
          "blockers": "{{ getBlockers.data }}",
          "performance": "{{ getTeamPerformance.data }}",
          "okrs": "{{ getOKRAlignment.data }}"
        }
      }
    }
  ],
  "components": [
    {
      "id": "mainContainer",
      "type": "container",
      "properties": {
        "backgroundColor": "#0f0f0f",
        "padding": "24px"
      },
      "children": [
        {
          "id": "header",
          "type": "container",
          "properties": {
            "direction": "row",
            "justifyContent": "space-between",
            "marginBottom": "24px"
          },
          "children": [
            {
              "id": "title",
              "type": "text",
              "properties": {
                "value": "Project Intelligence Dashboard",
                "size": "h1",
                "color": "#ffffff",
                "weight": "bold"
              }
            },
            {
              "id": "actionButtons",
              "type": "container",
              "properties": {
                "direction": "row",
                "gap": "12px"
              },
              "children": [
                {
                  "type": "button",
                  "properties": {
                    "text": "Generate Report",
                    "style": "outline",
                    "onClick": "{{ reportModal.open() }}"
                  }
                },
                {
                  "type": "button",
                  "properties": {
                    "text": "Refresh All",
                    "color": "primary",
                    "onClick": "{{ utils.refreshAllQueries() }}"
                  }
                }
              ]
            }
          ]
        },
        {
          "id": "tabContainer",
          "type": "tabs",
          "properties": {
            "defaultTab": "portfolio"
          },
          "tabs": [
            {
              "id": "portfolio",
              "label": "Portfolio Overview",
              "components": [
                {
                  "id": "portfolioMetrics",
                  "type": "container",
                  "properties": {
                    "direction": "row",
                    "gap": "16px",
                    "marginBottom": "24px"
                  },
                  "children": [
                    {
                      "type": "statistic",
                      "properties": {
                        "label": "Active Projects",
                        "value": "{{ getProjectPortfolio.data?.length || 0 }}",
                        "backgroundColor": "#1a1a1a"
                      }
                    },
                    {
                      "type": "statistic",
                      "properties": {
                        "label": "On Track",
                        "value": "{{ utils.countByStatus(getProjectPortfolio.data, 'on_track') }}",
                        "suffix": "%",
                        "backgroundColor": "#1a1a1a",
                        "valueColor": "#10b981"
                      }
                    },
                    {
                      "type": "statistic",
                      "properties": {
                        "label": "At Risk",
                        "value": "{{ utils.countByStatus(getProjectPortfolio.data, 'at_risk') }}",
                        "backgroundColor": "#1a1a1a",
                        "valueColor": "#f59e0b"
                      }
                    },
                    {
                      "type": "statistic",
                      "properties": {
                        "label": "Blocked",
                        "value": "{{ utils.countByStatus(getProjectPortfolio.data, 'blocked') }}",
                        "backgroundColor": "#1a1a1a",
                        "valueColor": "#ef4444"
                      }
                    }
                  ]
                },
                {
                  "id": "projectsTable",
                  "type": "table",
                  "properties": {
                    "data": "{{ getProjectPortfolio.data }}",
                    "columns": [
                      {
                        "key": "name",
                        "label": "Project",
                        "width": "25%",
                        "render": "{{ utils.renderProjectName(item) }}"
                      },
                      {
                        "key": "status",
                        "label": "Status",
                        "width": "12%",
                        "render": "{{ utils.renderStatus(item.status) }}"
                      },
                      {
                        "key": "progress",
                        "label": "Progress",
                        "width": "15%",
                        "render": "{{ utils.renderProgress(item.progress) }}"
                      },
                      {
                        "key": "team",
                        "label": "Team",
                        "width": "15%"
                      },
                      {
                        "key": "due_date",
                        "label": "Due Date",
                        "width": "12%",
                        "format": "date"
                      },
                      {
                        "key": "blockers",
                        "label": "Blockers",
                        "width": "8%",
                        "render": "{{ utils.renderBlockerCount(item.blockers) }}"
                      },
                      {
                        "key": "health_score",
                        "label": "Health",
                        "width": "13%",
                        "render": "{{ utils.renderHealthScore(item.health_score) }}"
                      }
                    ],
                    "rowActions": [
                      {
                        "label": "View Details",
                        "onClick": "{{ selectedProject.setValue(item) && projectDetailsModal.open() }}"
                      },
                      {
                        "label": "Update Status",
                        "onClick": "{{ selectedProject.setValue(item) && statusUpdateModal.open() }}"
                      }
                    ],
                    "backgroundColor": "#1a1a1a",
                    "onRowClick": "{{ selectedProject.setValue(currentRow) }}"
                  }
                }
              ]
            },
            {
              "id": "okr_alignment",
              "label": "OKR Alignment",
              "components": [
                {
                  "id": "quarterSelector",
                  "type": "container",
                  "properties": {
                    "direction": "row",
                    "justifyContent": "flex-end",
                    "marginBottom": "16px"
                  },
                  "children": [
                    {
                      "id": "quarterSelect",
                      "type": "select",
                      "properties": {
                        "options": [
                          { "value": "Q1-2024", "label": "Q1 2024" },
                          { "value": "Q2-2024", "label": "Q2 2024" },
                          { "value": "Q3-2024", "label": "Q3 2024" },
                          { "value": "Q4-2024", "label": "Q4 2024" }
                        ],
                        "defaultValue": "{{ utils.getCurrentQuarter() }}",
                        "onChange": "{{ getOKRAlignment.trigger() }}"
                      }
                    }
                  ]
                },
                {
                  "id": "okrContainer",
                  "type": "container",
                  "properties": {
                    "gap": "16px"
                  },
                  "children": [
                    {
                      "type": "listView",
                      "properties": {
                        "data": "{{ getOKRAlignment.data?.objectives }}",
                        "itemTemplate": {
                          "type": "card",
                          "properties": {
                            "backgroundColor": "#1a1a1a",
                            "padding": "20px",
                            "marginBottom": "16px"
                          },
                          "children": [
                            {
                              "type": "text",
                              "properties": {
                                "value": "{{ item.title }}",
                                "size": "h3",
                                "weight": "bold",
                                "marginBottom": "12px"
                              }
                            },
                            {
                              "type": "progressBar",
                              "properties": {
                                "value": "{{ item.progress }}",
                                "max": 100,
                                "color": "{{ item.progress >= 70 ? 'success' : item.progress >= 40 ? 'warning' : 'danger' }}",
                                "height": "8px",
                                "marginBottom": "16px"
                              }
                            },
                            {
                              "type": "container",
                              "properties": {
                                "direction": "row",
                                "gap": "24px"
                              },
                              "children": [
                                {
                                  "type": "text",
                                  "properties": {
                                    "value": "Key Results:",
                                    "weight": "medium",
                                    "color": "#888"
                                  }
                                },
                                {
                                  "type": "container",
                                  "properties": {
                                    "gap": "8px"
                                  },
                                  "children": [
                                    {
                                      "type": "listView",
                                      "properties": {
                                        "data": "{{ item.key_results }}",
                                        "itemTemplate": {
                                          "type": "container",
                                          "properties": {
                                            "direction": "row",
                                            "gap": "12px",
                                            "alignItems": "center"
                                          },
                                          "children": [
                                            {
                                              "type": "icon",
                                              "properties": {
                                                "icon": "{{ item.completed ? 'check-circle' : 'circle' }}",
                                                "color": "{{ item.completed ? '#10b981' : '#666' }}"
                                              }
                                            },
                                            {
                                              "type": "text",
                                              "properties": {
                                                "value": "{{ item.title }} ({{ item.current }}/{{ item.target }})"
                                              }
                                            }
                                          ]
                                        }
                                      }
                                    }
                                  ]
                                }
                              ]
                            },
                            {
                              "type": "container",
                              "properties": {
                                "marginTop": "16px"
                              },
                              "children": [
                                {
                                  "type": "text",
                                  "properties": {
                                    "value": "Aligned Projects:",
                                    "weight": "medium",
                                    "color": "#888",
                                    "marginBottom": "8px"
                                  }
                                },
                                {
                                  "type": "container",
                                  "properties": {
                                    "direction": "row",
                                    "wrap": true,
                                    "gap": "8px"
                                  },
                                  "children": [
                                    {
                                      "type": "listView",
                                      "properties": {
                                        "data": "{{ item.aligned_projects }}",
                                        "itemTemplate": {
                                          "type": "badge",
                                          "properties": {
                                            "text": "{{ item.name }}",
                                            "color": "primary"
                                          }
                                        }
                                      }
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        }
                      }
                    }
                  ]
                }
              ]
            },
            {
              "id": "blockers",
              "label": "Blockers & Actions",
              "components": [
                {
                  "id": "blockersHeader",
                  "type": "container",
                  "properties": {
                    "direction": "row",
                    "justifyContent": "space-between",
                    "marginBottom": "16px"
                  },
                  "children": [
                    {
                      "type": "text",
                      "properties": {
                        "value": "Active Blockers ({{ getBlockers.data?.length || 0 }})",
                        "size": "h3",
                        "weight": "bold"
                      }
                    },
                    {
                      "type": "button",
                      "properties": {
                        "text": "AI Recommendations",
                        "color": "primary",
                        "onClick": "{{ getAIRecommendations.trigger() }}"
                      }
                    }
                  ]
                },
                {
                  "id": "blockersGrid",
                  "type": "grid",
                  "properties": {
                    "columns": 2,
                    "gap": "16px"
                  },
                  "children": [
                    {
                      "id": "blockersList",
                      "type": "listView",
                      "properties": {
                        "data": "{{ getBlockers.data }}",
                        "height": "500px",
                        "itemTemplate": {
                          "type": "card",
                          "properties": {
                            "backgroundColor": "#1a1a1a",
                            "borderLeft": "4px solid {{ item.priority === 'critical' ? '#ef4444' : item.priority === 'high' ? '#f59e0b' : '#3b82f6' }}",
                            "padding": "16px",
                            "marginBottom": "12px"
                          },
                          "children": [
                            {
                              "type": "container",
                              "properties": {
                                "direction": "row",
                                "justifyContent": "space-between",
                                "marginBottom": "8px"
                              },
                              "children": [
                                {
                                  "type": "text",
                                  "properties": {
                                    "value": "{{ item.project_name }}",
                                    "weight": "bold"
                                  }
                                },
                                {
                                  "type": "text",
                                  "properties": {
                                    "value": "{{ item.age_days }} days",
                                    "size": "small",
                                    "color": "{{ item.age_days > 7 ? '#ef4444' : '#888' }}"
                                  }
                                }
                              ]
                            },
                            {
                              "type": "text",
                              "properties": {
                                "value": "{{ item.description }}",
                                "marginBottom": "8px"
                              }
                            },
                            {
                              "type": "container",
                              "properties": {
                                "direction": "row",
                                "gap": "12px",
                                "alignItems": "center"
                              },
                              "children": [
                                {
                                  "type": "text",
                                  "properties": {
                                    "value": "Owner: {{ item.owner }}",
                                    "size": "small",
                                    "color": "#888"
                                  }
                                },
                                {
                                  "type": "text",
                                  "properties": {
                                    "value": "‚Ä¢",
                                    "color": "#666"
                                  }
                                },
                                {
                                  "type": "text",
                                  "properties": {
                                    "value": "{{ item.source }}",
                                    "size": "small",
                                    "color": "#888"
                                  }
                                }
                              ]
                            }
                          ]
                        }
                      }
                    },
                    {
                      "id": "aiRecommendations",
                      "type": "card",
                      "properties": {
                        "title": "AI Recommendations",
                        "backgroundColor": "#1a1a1a",
                        "hidden": "{{ !getAIRecommendations.data }}"
                      },
                      "children": [
                        {
                          "type": "listView",
                          "properties": {
                            "data": "{{ getAIRecommendations.data?.recommendations }}",
                            "itemTemplate": {
                              "type": "container",
                              "properties": {
                                "padding": "12px",
                                "backgroundColor": "#2a2a2a",
                                "borderRadius": "6px",
                                "marginBottom": "8px"
                              },
                              "children": [
                                {
                                  "type": "text",
                                  "properties": {
                                    "value": "{{ item.action }}",
                                    "weight": "medium",
                                    "marginBottom": "4px"
                                  }
                                },
                                {
                                  "type": "text",
                                  "properties": {
                                    "value": "{{ item.rationale }}",
                                    "size": "small",
                                    "color": "#888"
                                  }
                                },
                                {
                                  "type": "button",
                                  "properties": {
                                    "text": "Create Task",
                                    "size": "small",
                                    "style": "outline",
                                    "marginTop": "8px",
                                    "onClick": "{{ utils.createTaskFromRecommendation(item) }}"
                                  }
                                }
                              ]
                            }
                          }
                        }
                      ]
                    }
                  ]
                }
              ]
            },
            {
              "id": "team_performance",
              "label": "Team Performance",
              "components": [
                {
                  "id": "periodSelector",
                  "type": "container",
                  "properties": {
                    "direction": "row",
                    "justifyContent": "flex-end",
                    "marginBottom": "16px"
                  },
                  "children": [
                    {
                      "id": "periodSelect",
                      "type": "select",
                      "properties": {
                        "options": [
                          { "value": "week", "label": "This Week" },
                          { "value": "month", "label": "This Month" },
                          { "value": "quarter", "label": "This Quarter" }
                        ],
                        "defaultValue": "month",
                        "onChange": "{{ getTeamPerformance.trigger() }}"
                      }
                    }
                  ]
                },
                {
                  "id": "performanceGrid",
                  "type": "grid",
                  "properties": {
                    "columns": 2,
                    "gap": "16px"
                  },
                  "children": [
                    {
                      "id": "velocityChart",
                      "type": "chart",
                      "properties": {
                        "title": "Team Velocity",
                        "type": "line",
                        "data": "{{ getTeamPerformance.data?.velocity }}",
                        "x": "sprint",
                        "y": ["completed", "committed"],
                        "backgroundColor": "#1a1a1a"
                      }
                    },
                    {
                      "id": "performanceMetrics",
                      "type": "container",
                      "properties": {
                        "gap": "12px"
                      },
                      "children": [
                        {
                          "type": "statistic",
                          "properties": {
                            "label": "Average Velocity",
                            "value": "{{ getTeamPerformance.data?.metrics?.avg_velocity || 0 }}",
                            "suffix": " pts/sprint",
                            "backgroundColor": "#1a1a1a"
                          }
                        },
                        {
                          "type": "statistic",
                          "properties": {
                            "label": "Completion Rate",
                            "value": "{{ getTeamPerformance.data?.metrics?.completion_rate || 0 }}",
                            "suffix": "%",
                            "backgroundColor": "#1a1a1a"
                          }
                        },
                        {
                          "type": "statistic",
                          "properties": {
                            "label": "Cycle Time",
                            "value": "{{ getTeamPerformance.data?.metrics?.avg_cycle_time || 0 }}",
                            "suffix": " days",
                            "backgroundColor": "#1a1a1a"
                          }
                        }
                      ]
                    }
                  ]
                },
                {
                  "id": "teamTable",
                  "type": "table",
                  "properties": {
                    "title": "Individual Performance",
                    "data": "{{ getTeamPerformance.data?.team_members }}",
                    "columns": [
                      {
                        "key": "name",
                        "label": "Team Member",
                        "width": "25%"
                      },
                      {
                        "key": "completed_tasks",
                        "label": "Completed",
                        "width": "15%"
                      },
                      {
                        "key": "in_progress",
                        "label": "In Progress",
                        "width": "15%"
                      },
                      {
                        "key": "velocity",
                        "label": "Velocity",
                        "width": "15%"
                      },
                      {
                        "key": "efficiency",
                        "label": "Efficiency",
                        "width": "15%",
                        "render": "{{ utils.renderEfficiency(item.efficiency) }}"
                      },
                      {
                        "key": "sentiment",
                        "label": "Sentiment",
                        "width": "15%",
                        "render": "{{ utils.renderSentiment(item.sentiment_score) }}"
                      }
                    ],
                    "backgroundColor": "#1a1a1a",
                    "marginTop": "24px"
                  }
                }
              ]
            },
            {
              "id": "analytics",
              "label": "Analytics & Reports",
              "components": [
                {
                  "id": "analyticsContainer",
                  "type": "container",
                  "properties": {
                    "gap": "24px"
                  },
                  "children": [
                    {
                      "id": "crossPlatformChart",
                      "type": "chart",
                      "properties": {
                        "title": "Cross-Platform Activity",
                        "type": "bar",
                        "data": "{{ utils.getCrossPlatformData() }}",
                        "x": "platform",
                        "y": ["issues", "commits", "messages"],
                        "backgroundColor": "#1a1a1a",
                        "height": "300px"
                      }
                    },
                    {
                      "id": "reportsSection",
                      "type": "card",
                      "properties": {
                        "title": "Generated Reports",
                        "backgroundColor": "#1a1a1a"
                      },
                      "children": [
                        {
                          "type": "listView",
                          "properties": {
                            "data": "{{ generatedReports.value }}",
                            "itemTemplate": {
                              "type": "container",
                              "properties": {
                                "direction": "row",
                                "justifyContent": "space-between",
                                "padding": "12px",
                                "borderBottom": "1px solid #2a2a2a"
                              },
                              "children": [
                                {
                                  "type": "text",
                                  "properties": {
                                    "value": "{{ item.name }}"
                                  }
                                },
                                {
                                  "type": "text",
                                  "properties": {
                                    "value": "{{ moment(item.created_at).format('MMM DD, YYYY') }}",
                                    "color": "#888"
                                  }
                                },
                                {
                                  "type": "button",
                                  "properties": {
                                    "text": "Download",
                                    "size": "small",
                                    "style": "outline",
                                    "onClick": "{{ utils.downloadReport(item.id) }}"
                                  }
                                }
                              ]
                            }
                          }
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ]
        }
      ]
    }
  ],
  "modals": [
    {
      "id": "reportModal",
      "title": "Generate Custom Report",
      "components": [
        {
          "id": "reportTypeSelect",
          "type": "select",
          "properties": {
            "label": "Report Type",
            "options": [
              { "value": "executive_summary", "label": "Executive Summary" },
              { "value": "project_status", "label": "Project Status Report" },
              { "value": "team_performance", "label": "Team Performance Report" },
              { "value": "risk_assessment", "label": "Risk Assessment" }
            ]
          }
        },
        {
          "id": "projectMultiSelect",
          "type": "multiselect",
          "properties": {
            "label": "Projects to Include",
            "options": "{{ getProjectPortfolio.data.map(p => ({ value: p.id, label: p.name })) }}",
            "placeholder": "Select projects..."
          }
        },
        {
          "id": "reportDateRange",
          "type": "dateRangePicker",
          "properties": {
            "label": "Date Range"
          }
        },
        {
          "id": "includeMetricsToggle",
          "type": "switch",
          "properties": {
            "label": "Include Detailed Metrics",
            "defaultValue": true
          }
        }
      ],
      "footer": [
        {
          "type": "button",
          "properties": {
            "text": "Cancel",
            "onClick": "{{ reportModal.close() }}"
          }
        },
        {
          "type": "button",
          "properties": {
            "text": "Generate Report",
            "color": "primary",
            "onClick": "{{ generateReport.trigger() && reportModal.close() }}"
          }
        }
      ]
    },
    {
      "id": "statusUpdateModal",
      "title": "Update Project Status",
      "components": [
        {
          "type": "text",
          "properties": {
            "value": "Project: {{ selectedProject.value?.name }}",
            "weight": "bold",
            "marginBottom": "16px"
          }
        },
        {
          "id": "statusSelect",
          "type": "select",
          "properties": {
            "label": "New Status",
            "options": [
              { "value": "on_track", "label": "On Track", "color": "#10b981" },
              { "value": "at_risk", "label": "At Risk", "color": "#f59e0b" },
              { "value": "blocked", "label": "Blocked", "color": "#ef4444" },
              { "value": "completed", "label": "Completed", "color": "#3b82f6" }
            ],
            "defaultValue": "{{ selectedProject.value?.status }}"
          }
        },
        {
          "id": "statusNotes",
          "type": "textArea",
          "properties": {
            "label": "Status Notes",
            "placeholder": "Add any relevant notes about this status change...",
            "rows": 4
          }
        }
      ],
      "footer": [
        {
          "type": "button",
          "properties": {
            "text": "Cancel",
            "onClick": "{{ statusUpdateModal.close() }}"
          }
        },
        {
          "type": "button",
          "properties": {
            "text": "Update Status",
            "color": "primary",
            "onClick": "{{ updateProjectStatus.trigger() && statusUpdateModal.close() }}"
          }
        }
      ]
    }
  ],
  "utils": {
    "countByStatus": "function(projects, status) { if (!projects) return 0; return projects.filter(p => p.status === status).length }",
    "renderProjectName": "function(project) { return `<div><strong>${project.name}</strong><br/><span style='color: #888; font-size: 12px'>${project.platform}</span></div>` }",
    "renderStatus": "function(status) { const colors = { on_track: '#10b981', at_risk: '#f59e0b', blocked: '#ef4444', completed: '#3b82f6' }; return `<span style='color: ${colors[status]}'>‚óè ${status.replace('_', ' ').toUpperCase()}</span>` }",
    "renderProgress": "function(progress) { const color = progress >= 70 ? '#10b981' : progress >= 40 ? '#f59e0b' : '#ef4444'; return `<div style='width: 100%; background: #2a2a2a; border-radius: 4px; height: 8px'><div style='width: ${progress}%; background: ${color}; height: 100%; border-radius: 4px'></div></div><span style='font-size: 12px; color: #888'>${progress}%</span>` }",
    "renderBlockerCount": "function(count) { if (!count || count === 0) return '<span style=\"color: #10b981\">0</span>'; return `<span style='color: ${count > 2 ? '#ef4444' : '#f59e0b'}'>${count}</span>` }",
    "renderHealthScore": "function(score) { const color = score >= 80 ? '#10b981' : score >= 60 ? '#f59e0b' : '#ef4444'; return `<div style='display: flex; align-items: center'><div style='width: 40px; height: 8px; background: #2a2a2a; border-radius: 4px; margin-right: 8px'><div style='width: ${score}%; height: 100%; background: ${color}; border-radius: 4px'></div></div><span style='color: ${color}'>${score}%</span></div>` }",
    "getCurrentQuarter": "function() { const now = new Date(); const quarter = Math.floor(now.getMonth() / 3) + 1; return `Q${quarter}-${now.getFullYear()}` }",
    "renderEfficiency": "function(efficiency) { const color = efficiency >= 90 ? '#10b981' : efficiency >= 70 ? '#f59e0b' : '#ef4444'; return `<span style='color: ${color}'>${efficiency}%</span>` }",
    "renderSentiment": "function(score) { const emoji = score >= 80 ? 'üòä' : score >= 60 ? 'üòê' : 'üòü'; return `${emoji} ${score}%` }",
    "getCrossPlatformData": "function() { return [ { platform: 'Linear', issues: 45, commits: 0, messages: 12 }, { platform: 'GitHub', issues: 23, commits: 156, messages: 34 }, { platform: 'Asana', issues: 31, commits: 0, messages: 8 }, { platform: 'Slack', issues: 0, commits: 0, messages: 234 } ] }",
    "createTaskFromRecommendation": "function(rec) { issueTitle.setValue(rec.action); issueDescription.setValue(rec.rationale); createIssueModal.open() }",
    "downloadReport": "function(id) { window.open(`${sophia_api.baseURL}/projects/reports/${id}/download`, '_blank') }",
    "refreshAllQueries": "function() { getProjectPortfolio.trigger(); getOKRAlignment.trigger(); getBlockers.trigger(); getTeamPerformance.trigger() }"
  },
  "state": {
    "selectedProject": {
      "initialValue": null,
      "persist": false
    },
    "generatedReports": {
      "initialValue": [],
      "persist": true
    }
  },
  "styles": {
    "global": {
      "fontFamily": "'Inter', -apple-system, BlinkMacSystemFont, sans-serif",
      "backgroundColor": "#0f0f0f",
      "color": "#ffffff"
    },
    "components": {
      ".badge": {
        "backgroundColor": "#3b82f6",
        "color": "#ffffff",
        "padding": "4px 8px",
        "borderRadius": "4px",
        "fontSize": "12px",
        "display": "inline-block"
      }
    }
  }
}
